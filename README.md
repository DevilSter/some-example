# Pre
в hosts прописать 
```
127.0.0.1 example.loc
```

# Запуск Docker
Переходим в папку docker 

Запускаем
```
docker-compose build
```
База db_simple должна будет создаться автоматически

Запускаем наши контейнеры
```
docker-compose up
```

# Миграции
Переходим в контейнер с вебом 
```
make jumpin
```

1. Создаем нужные таблицы 
    ```
       php bin/console doctrine:migrations:migrate
    ```
2. Заполняем фикстуры
    ```
       php bin/console doctrine:fixtures:load
    ``` 
_Не использовал faker так как там на английском, а хотелось бы на русском. Готовый не нашел, а писать свой аналог не хочется сейчас._

# Маршруты (адреса, API)

1. Список авторов (GET)
      - http://example.loc/author  (первая страница 20 авторов)
      - http://example.loc/author/4 (четвертая страница 20 авторов)
      - http://example.loc/author/4/40 (4 страница 40 авторов)
 
2. Создание автора (POST)
      - http://example.loc/author/create 
        ```
          в теле JSON 
          {
              "first_name":"Some Name",
              "middle_name": "Yur",
              "last_name":"Some Surname"
          }
        ```
        Обязательно только имя

3. Создание книги (POST)
    - http://example.loc/book/create
        ```
          в теле JSON
          {
              "title":"Book 1",
              "authors": [
                  34439, 34441, 27557
              ]
          }
        ```
        ИД для списка авторов можно посмотреть в запросе списка авторов. ИД обязательно хотя бы один существующий
  
4. Поиск по книгам (POST)
    - http://example.loc/book/search
        ```
            в теле JSON
            {
                "title": "Алмазы"
            }
        ```

# Тесты

в контейнере с вебом в корне **/var/www** запускаем 
```
./bin/phpunit
```
- Простых тестов нет (не предусмотрены логикой)
- Немного функциональных тестов для примера

**_Они проходят, но внизу будет нотайс на него можно пока не обращать внимания, библиотека для отката транзакций в тестах 
пока не совсем умеет в новый Doctrine DBAL. В ближайшее время релизнутся и будет норм._**

# Локализация
Так как в БД не делал отдельного поля под перевод и создавать файл перевода на несколько тысяч записей тоже не айс. Сделал проще. 

Добавил переключение локалей в контролере на метод и просто транслителировал название если английское название

**Достучаться можно по урлу:**
- http://example.loc/en/book/13
- http://example.loc/ru/book/13
